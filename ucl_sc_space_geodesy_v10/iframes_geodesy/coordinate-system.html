<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Three.js Transforms</title>
    
    <style type="text/css">
      html { overflow: hidden; }
      body { margin: 0; padding: 0; overflow: hidden; font-family: Monospace; font-size: 13px; line-height: 20px; color: #333; }

      a { color: #0088cc; text-decoration: none; }
      a:hover, a:focus { color: #005580; text-decoration: underline; }
    </style>

  </head>

  <body>

    <div id="container"></div>
    
    <script src="three/three.min.js"></script>
    <script src="three/OrbitControls.js"></script>
    <script src="three/WebGL.js"></script>
    <script src="three/helper.js"></script>
    <script src="three/libs/dat.gui.min.js"></script>
    <script src="three/libs/tween.min.js"></script>

    <script>

      if ( !WEBGL.isWebGLAvailable() ) {
        document.body.appendChild( WEBGL.getWebGLErrorMessage() );
      }

      var container;

      var camera, controls, scene, renderer;

      var mesh;

      var mouseX = 0, mouseY = 0;

      var clock = new THREE.Clock();

      var windowHalfX = window.innerWidth / 2;
      var windowHalfY = window.innerHeight / 2;

      init();
      animate();

      function init() {

        container = document.getElementById( 'container' );

        camera = new THREE.PerspectiveCamera( 60, window.innerWidth / window.innerHeight, 1, 100000 );
        camera.position.set( -10, 100, 300 );

        scene = new THREE.Scene();
        // var object = new THREE.Object3D();

        // add a cylinder
        var geometry_cyl = new THREE.CylinderGeometry(1,1,200,10);
        var material = new THREE.MeshBasicMaterial({ color: 0xdc241f });  // Central Line Red
        var wireframe = new THREE.WireframeGeometry( geometry_cyl );
        var line = new THREE.LineSegments( wireframe );
        line.material.color.setHex(0xdc241f);                             // Central Line Red
        // var geometry = new THREE.BoxGeometry( 100, 100, 100, 1, 1, 1 );
        // var geometry = new THREE.SphereBufferGeometry( 100,80,80 );

        // Create the x-axis
        mesh = new THREE.Mesh( geometry_cyl, material );
        mesh.position.set( 0, 0, 0 );
        mesh.rotation.z = Math.PI/2;
        mesh.position.x += 100 ;
        mesh.add( line );

        // mesh z-axis
        var matz = new THREE.MeshBasicMaterial({ color: 0x0019a8 });  // Central Line Red
        meshz = new THREE.Mesh(geometry_cyl, matz);
        meshz.position.set(0,0,0);
        meshz.rotation.x = Math.PI/2;
        meshz.position.z +=100;
        var linez = line;
        linez.material.color.setHex(0x0019a8);                             // Central Line Red
        meshz.add(linez);

        // mesh z-axis
        var maty = new THREE.MeshBasicMaterial({ color: 0x007d32 });  // Central Line Red
        meshy = new THREE.Mesh(geometry_cyl, maty);
        meshy.position.set(0,0,0);
        meshy.rotation.y = Math.PI/2;
        meshy.position.y +=100;
        var liney = line;
        liney.material.color.setHex(0x007d32);                             // Central Line Red
        meshy.add(liney);

        // object.add(mesh);
        // object.add(meshy);
        // object.add(meshz);

        //scene.add( object );
        scene.add(mesh);
        scene.add(meshy);
        scene.add(meshz);

        // plotaxes(scene);
        // setupTween();


        renderer = new THREE.WebGLRenderer( { antialias: true, alpha: true } );
        // renderer.setClearColor( 0xBBBBBB, 1 );
        renderer.setClearColor( 0x000000, 0 ); // the default
        renderer.setSize( window.innerWidth, window.innerHeight );

        container.appendChild( renderer.domElement );


        controls = new THREE.OrbitControls( camera, renderer.domElement );
        controls.enableKeys = false;

        // document.addEventListener( 'mousemove', onDocumentMouseMove, false );

        //

        window.addEventListener( 'resize', onWindowResize, false );

      }


      // function setupGui() {
      //   // dat.GUI debugging -----------------------------------------
      //   var gui = new dat.GUI();
      //   var f1 = gui.addFolder('meshOuter rotation');
      //   // f1.add(mesh.position, 'x', 0, 2*Math.PI);
      //   // f1.add(mesh.position, 'y', 0, 2*Math.PI);
      //   // f1.add(mesh.position, 'z', 0, 2*Math.PI);
      //   f1.open();
      // }


      function onWindowResize() {

        windowHalfX = window.innerWidth / 2;
        windowHalfY = window.innerHeight / 2;

        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();

        renderer.setSize( window.innerWidth, window.innerHeight );

      }

      function onDocumentMouseMove( event ) {

        mouseX = ( event.clientX - windowHalfX );
        mouseY = ( event.clientY - windowHalfY );

        // document.getElementById('mouse').innerText = mouseX + ', ' + mouseY;

      }

      //

      var paused = false;

      function animate() {
        requestAnimationFrame( animate );
        if (!paused) {
          render();
          controls.update();
          TWEEN.update();
        }
      }

      function render() {
        var delta = clock.getDelta();

        if (mesh) {
          mesh.rotation.y -= 1.0 * delta;
        }
        if (meshz)
        {
            meshz.rotation.y -= 1.0 * delta;
        }

        renderer.render( scene, camera );
      }




      function setupTween(obj, prop, targetValue) {
        var update  = function(){
          obj[prop] = current.property;
        }
        
        var current = { property: obj[prop] };
        var target = { property: targetValue };

        var tween = new TWEEN.Tween(current).to(target, 800)
          .easing(TWEEN.Easing.Cubic.Out)
          .onUpdate(update);

        tween.start();
      }

      var step = 1;

      var opts = { scale: 1 }

      function applyStep(step) {
        // console.log(step);
        if      (step == 1) {
          // setupTween( mesh.position, 'x', 100);
          // setupTween( meshy.position, 'x', 100);
          // setupTween( meshz.position, 'x', 100);

        }
        else if (step == 2) {
          // setupTween( mesh.position, 'x', -50);
          // setupTween( meshy.position, 'x', -50);
          // setupTween( meshz.position, 'x', -50);
          
          // setupTween( mesh.scale, 'x', 1);
          // setupTween( mesh.scale, 'y', 1);
          // setupTween( mesh.scale, 'z', 1);
        }
        else if (step == 3) {
          // setupTween( mesh.position, 'x', 80);
          setupTween( meshy.position, 'x', 80);
          setupTween( meshz.position, 'x', 80);

          setupTween( mesh.scale, 'x', 1);
          setupTween( mesh.scale, 'y', 1);
          setupTween( mesh.scale, 'z', 1);
        }
        else if (step == 4) {
          setupTween( mesh.position, 'x', 0);
        
          setupTween( mesh.scale, 'x', 1);
          setupTween( mesh.scale, 'y', 1);
          setupTween( mesh.scale, 'z', 1);
        }
        else if (step == 5) {
          setupTween( mesh.scale, 'x', 1.3);
          setupTween( mesh.scale, 'y', 1.3);
          setupTween( mesh.scale, 'z', 1.3);
        }
        else if (step == 6) {
          setupTween( mesh.scale, 'x', 0.7);
          setupTween( mesh.scale, 'y', 0.7);
          setupTween( mesh.scale, 'z', 0.7);
        }
        else if (step == 7) {
          setupTween( mesh.scale, 'x', 1.0);
          setupTween( mesh.scale, 'y', 0.8);
          setupTween( mesh.scale, 'z', 1.0);
          setupTween( mesh.rotation, 'y', Math.PI / 4);
        }
        else if (step == 8) {
          setupTween( mesh.rotation, 'y', Math.PI * 5 / 4);
           
        }
      }

      // onmessage = function(e) {
      //   // paused = (e.data == 'pause' || e.data == 'slide:stop');
      //   step = e.data.director.args[0];
      //   applyStep( step );
      // };

      function forward() {
        step++;
        if (step > 5) { step = 5; return; }
        applyStep(step);
      }

      function back() {
        step--;
        if (step <= 0) { step = 1; return; }
        applyStep(step);
      }

      // Controls for stand-alone
      window.addEventListener('keydown', function (e) {
        if (e.keyCode == 38 || e.keyCode == 37) back();
        if (e.keyCode == 40 || e.keyCode == 39) forward();
      });

    </script>

  </body>
</html>
